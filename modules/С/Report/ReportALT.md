## ПЕРЕСТАНОВКИ И СИММЕТРИЧЕСКАЯ ГРУППА: ТЕОРИЯ И ПРАКТИЧЕСКИЕ ПРИЛОЖЕНИЯ


### Исследовательский отчет

### Санкт-Петербургский государственный электротехнический
университет «ЛЭТИ» им. В.И. Ульянова (Ленина)

##### Работу выполнил: Валиев Руслан Александрович 
##### Группа 4381



ОГЛАВЛЕНИЕ

1. Введение
2. Основные определения и свойства перестановок
   2.1 Определения и представления перестановок
   2.2 Обращение элемента и обратная перестановка
3. Композиция и групповая структура
   3.1 Композиция подстановок
   3.2 Групповые свойства
4. Цикловое разложение
   4.1 Определение цикла и теорема о разложении
   4.2 Примеры и дополнительные свойства
5. Четность и знак перестановки
   5.1 Инверсии и знак перестановки
   5.2 Вычисление знака перестановки
6. Порядок элемента в группе
7. Приложения и практические задачи
8. Тесты и верификация алгоритмов
   8.1 Тестирование основных операций
   8.2 Реализация алгоритмов
9. Теоретические дополнения
10. Заключение
11. Список использованных источников


---

## 1. ВВЕДЕНИЕ

Теория перестановок и симметрической группы является одним из фундаментальных разделов дискретной математики с многочисленными приложениями в компьютерных науках, анализе алгоритмов и математической физике. Симметрическая группа S_n, представляющая множество всех взаимно однозначных отображений конечного множества на себя, служит основной моделью для изучения структуры групп, операций над дискретными объектами и анализа сложности алгоритмов.

Актуальность данного исследования определяется следующими факторами:

1. Универсальность: по теореме Кэли любая конечная группа изоморфна подгруппе некоторой симметрической группы, что делает S_n ключевым объектом алгебры.

2. Практическое применение: перестановки используются в анализе алгоритмов сортировки, оптимизации маршрутов, комбинаторике и вычислительной сложности.

3. Теоретическое значение: свойства перестановок (четность, порядок, цикловое разложение) проявляются в различных областях математики и информатики.

Цель работы состоит в систематическом изложении теории перестановок с доказательствами ключевых теорем, демонстрацией практических приложений и разработкой эффективных алгоритмов.



# 2. ОСНОВНЫЕ ОПРЕДЕЛЕНИЯ И СВОЙСТВА ПЕРЕСТАНОВОК

## 2.1 Определения и представления перестановок

Определение 2.1. Перестановкой из n элементов называется упорядоченный набор (a_1, a_2, ..., a_n), в котором каждый элемент из множества {1, 2, ..., n} встречается ровно один раз.

Пример 2.1. Для n = 3 существует 6 перестановок: (1,2,3), (1,3,2), (2,1,3), (2,3,1), (3,1,2), (3,2,1).

**Определение 2.2.** Подстановкой (перестановкой как функцией) называется взаимно однозначное отображение σ: {1,...,n} → {1,...,n}. Обозначается как:

```
σ = | 1      2   ...  n   |
    |σ(1)  σ(2)  ... σ(n) |
```

или в компактной форме: $σ(1), σ(2), ..., σ(n)$.

**Теорема 2.1.** Количество всех перестановок из n элементов равно
$n! = 1·2·3·... · n$

**Доказательство.**
При построении перестановки для первой позиции имеем n вариантов выбора, для второй — (n-1) вариантов, для третьей — (n-2) варианта и т.д. По правилу произведения общее количество равно 
$n·(n-1)·(n-2)·...·1 = n!$ 

### Представления перестановок

В математике и информатике перестановки могут быть представлены несколькими эквивалентными способами, каждый из которых имеет свои преимущества в зависимости от контекста применения.

**Двухстрочная нотация:**

**Определение 2.3.** Двухстрочной нотацией перестановки σ называется:

```
σ = |  1    2     3   ...   n   |
    | σ(1) σ(2)  σ(3) ...  σ(n) |
```

**Пример 2.2.** Для перестановки из S₅: σ = (3, 5, 1, 4, 2)

```
σ = | 1  2  3  4  5 |
    | 3  5  1  4  2 |
```

### 2.4.2 Однострочная нотация

Запись только образов: **σ = (3, 5, 1, 4, 2)**

### 2.4.3 Цикловая нотация

Представление через циклы: **σ = (1 3)(2 5)(4)**

### 2.4.4 Матричное представление

Матрица перестановки для σ = (2, 3, 1):

```
P_σ = [ 0  0  1 ]
      [ 1  0  0 ]
      [ 0  1  0 ]
```

### 2.4.5 Таблица эквивалентных представлений

Для σ ∈ S₄ такой что $σ(1)=2, σ(2)=4, σ(3)=3, σ(4)=1$:

| Представление       | Запись                        |
| ------------------- | ----------------------------- |
| Двухстрочная        | \| 1 2 3 4 \| / \| 2 4 3 1 \| |
| Однострочная        | (2, 4, 3, 1)                  |
| Цикловая            | (1 2 4)(3) или (1 2 4)        |
| Компактная цикловая | (1 2 4)                       |

## 2.2 Обращение элемента и обратная перестановка

**Определение 2.4.** Обратной подстановкой σ⁻¹ называется перестановка, для которой σ⁻¹ ∘ σ = e.

**Алгоритм:** Если σ = (3, 5, 1, 4, 2), то σ⁻¹ находится по правилу: если σ(i) = j, то σ⁻¹(j) = i.

**Пример 2.3.**
- σ(1) = 3 ⟹ σ⁻¹(3) = 1
- σ(2) = 5 ⟹ σ⁻¹(5) = 2
- σ(3) = 1 ⟹ σ⁻¹(1) = 3
- σ(4) = 4 ⟹ σ⁻¹(4) = 4
- σ(5) = 2 ⟹ σ⁻¹(2) = 5

Результат: **σ⁻¹ = (3, 5, 1, 4, 2)**

Проверка: σ ∘ σ⁻¹ = (1, 2, 3, 4, 5) 

### Обратная подстановка

**Определение 2.7.** Обратной подстановкой σ⁻¹ к подстановке σ называется такая подстановка, что σ⁻¹ ∘ σ = σ ∘ σ⁻¹ = e (тождественная подстановка).

**Алгоритм вычисления обратной подстановки:**

Если в двухстрочной нотации:
```
σ = |  1     2     3   ...  n   |
    | σ(1)  σ(2)  σ(3) ... σ(n) |
```

то в σ⁻¹ меняются местами строки:
```
σ⁻¹ = | σ(1)  σ(2)  σ(3) ... σ(n) |
      |  1      2     3  ...   n  |
```

и переставляются столбцы так, чтобы первая строка была упорядочена:

**Пример 2.5.** Для σ = (3, 5, 1, 4, 2):

Двухстрочная запись:
```
σ = | 1  2  3  4  5 |
    | 3  5  1  4  2 |
```

Инвертируем (меняем строки):
```
| 3  5  1  4  2 |
| 1  2  3  4  5 |
```

Переставляем столбцы:
```
σ⁻¹ = | 1  2  3  4  5 |
      | 3  5  1  4  2 |
```

Из этого видно: $σ⁻¹(1)=3, σ⁻¹(2)=5, σ⁻¹(3)=1, σ⁻¹(4)=4, σ⁻¹(5)=2$

Однострочная запись: σ⁻¹ = (3, 5, 1, 4, 2)

Проверка: σ ∘ σ⁻¹ = e? 
- (σ ∘ σ⁻¹)(1) = σ(σ⁻¹(1)) = σ(3) = 1 
- (σ ∘ σ⁻¹)(2) = σ(σ⁻¹(2)) = σ(5) = 2 

### Свойства обратной подстановки

**Теорема 2.2.** Для любых σ, τ ∈ Sₙ:

1. (σ⁻¹)⁻¹ = σ
2. (σ ∘ τ)⁻¹ = τ⁻¹ ∘ σ⁻¹
3. Если σ = (c₁)(c₂)...(cₖ) где cᵢ — циклы, то σ⁻¹ = (c₁⁻¹)(c₂⁻¹)...(cₖ⁻¹)

**Доказательство свойства 2:**
```
(σ ∘ τ) ∘ (τ⁻¹ ∘ σ⁻¹) = σ ∘ (τ ∘ τ⁻¹) ∘ σ⁻¹ = σ ∘ e ∘ σ⁻¹ = σ ∘ σ⁻¹ = e
```

**Свойство 3 для циклов:** Для цикла (a₁ a₂ ... aₖ) обратным является (aₖ aₖ₋₁ ... a₁)

Пример: ((1 2 3))⁻¹ = (3 2 1)
Проверка: (1 2 3) ∘ (3 2 1) = e ✓

### Вычисление порядков инверсии

**Теорема 2.3.** Если σ⁻¹ — обратная подстановка, то:
- ord(σ) = ord(σ⁻¹)
- sgn(σ) = sgn(σ⁻¹)

**Доказательство первого свойства:**
Если σᵏ = e, то (σ⁻¹)ᵏ = (σᵏ)⁻¹ = e⁻¹ = e, поэтому порядки совпадают.

**Доказательство второго свойства:**
sgn(σ⁻¹) · sgn(σ) = sgn(σ⁻¹ ∘ σ) = sgn(e) = 1

# 3. КОМПОЗИЦИЯ И ГРУППОВАЯ СТРУКТУРА

## 3.1 Композиция подстановок

Определение 3.1. Композицией двух подстановок σ и τ называется их последовательное применение:

$(σ ∘ τ)(i) = σ(τ(i))$

То есть сначала применяется τ, потом σ.

## 3.2 Групповые свойства

Теорема 3.1. Множество $(S_n)$ всех подстановок множества ${1,...,n}$ с операцией композиции образует группу.

Доказательство. Проверяются четыре аксиомы группы:

1. Замкнутость: композиция двух биекций является биекцией, поэтому $σ ∘ τ ∈ S_n$

2. Ассоциативность: $[(σ ∘ τ) ∘ ρ](i) = (σ ∘ τ)(ρ(i)) = σ(τ(ρ(i))) = [σ ∘ (τ ∘ ρ)](i)$

3. Нейтральный элемент: тождественная подстановка $e(i) = i$ удовлетворяет $σ ∘ e = e ∘ σ = σ$

4. Обратный элемент: для каждой биекции σ существует обратная функция $σ^(-1)$ такая, что $σ ∘ σ^(-1) = e$

*Следствие 3.1* Порядок группы $S_n$ равен $|S_n| = n!$

### Некоммутативность

Теорема 3.2. При $n  ≥ 3$ группа $S_n$ некоммутативна.

Доказательство. Рассмотрим $σ = (2, 1, 3, 4, ..., n)$ и $τ = (1, 3, 2, 4, ..., n)$.

Тогда $σ ∘ τ ≠ τ ∘ σ$, что доказывает некоммутативность. ∎



# 4. ЦИКЛОВОЕ РАЗЛОЖЕНИЕ

## 4.1 Определение цикла и теорема о разложении

**Определение 4.1.** Циклом длины k называется подстановка вида $(a_1 a_2 ... a_k)$, которая переводит:
- $a_1 → a_2 → a_3 → ... → a_k → a_1$
- остальные элементы остаются неподвижными.

**Теорема 4.1** (Основная теорема циклового разложения). Любая подстановка σ ∈ S_n может быть единственным образом представлена как произведение независимых циклов.

**Доказательство.** Алгоритм разложения:
1. Начинаем с наименьшего непокрытого элемента.
2. Следуем цепочке: $i → σ(i) → σ²(i) → ... → i$.
3. Полученная последовательность образует цикл.
4. Повторяем для оставшихся элементов.

Единственность следует из того, что каждый элемент принадлежит ровно одному циклу. 

**Пример 4.1.** Разложим $σ = (7, 5, 1, 4, 2, 3, 6)$:
- Начинаем с $1: 1 → 7 → 6 → 3 → 1. Цикл (1 7 6 3)$.
- Продолжаем с 2: $2 → 5 → 2$. Цикл (2 5).
- Элемент 4: $4 → 4$ (неподвижная точка).

Итог: $σ = (1 7 6 3)(2 5)$.

## 4.2 Примеры и дополнительные свойства

### Количество циклов

**Общая формула:**

**Определение 4.2.** Обозначим через c(σ) общее количество циклов в разложении перестановки σ (включая неподвижные точки как циклы длины 1).

**Теорема 4.2.** Количество циклов в перестановке σ ∈ Sₙ можно вычислить как:

c(σ) = n - inv(σ)

где $inv(σ) = Σᵢ₌₁ⁿ Σⱼ₌ᵢ₊₁ⁿ δᵢⱼ$ — число инверсий...



**Теорема 4.2.** Для перестановки σ, обозначим c(σ) — число циклов в разложении.

Среднее число циклов в случайной перестановке:

$E[c(σ)] = 1 + \frac{1}{2} + \frac{1}{3} + ... + \frac{1}{n} = H_n \approx \ln(n) + 0.577$

**Пример 4.2.** Для $S₄: E[c] = H₄ = 1 + 0.5 + 0.333 + 0.25 ≈ 2.083$

| Цикловой тип | Количество | c(σ) |
|---|---|---|
| (1,1,1,1) | 1 | 4 |
| (2,1,1) | 6 | 3 |
| (2,2) | 3 | 2 |
| (3,1) | 8 | 2 |
| (4) | 6 | 1 |

### Графическое представление циклов

Цикл (a₁ a₂ ... aₖ) можно представить как ориентированный граф, где:
- Вершины: элементы 1, 2, ..., n
- Рёбра: стрелка от i к σ(i)

**Пример 4.3.** σ = (1 3 5)(2 4) можно визуализировать как граф с двумя компонентами связности:

```
Компонента 1: 1 → 3 → 5 → 1 (треугольник)
Компонента 2: 2 → 4 → 2 (двойная стрелка)
```

**Граф перестановки:**

Граф перестановки G(σ) имеет следующие свойства:
- Каждая вершина имеет ровно одно входящее и одно исходящее ребро (функция)
- Граф распадается на непересекающиеся циклы
- Число компонент связности = число циклов в разложении

### Сложность алгоритма разложения

**Теорема 4.3.** Алгоритм разложения перестановки σ ∈ Sₙ на независимые циклы имеет временную сложность:

$T(n) = O(n)$

**Доказательство:** Каждый элемент посещается ровно один раз, каждая операция (проверка посещённости, переход) требует O(1). Общее число операций ≤ cn для некоторой константы c.

**Пространственная сложность:**

$S(n) = O(n)$

для хранения:
- Массива посещённых вершин: O(n)
- Стека при поиске циклов: O(n) в худшем случае
- Массива результирующих циклов: O(n)

### Расширенные примеры для S₅

**Пример 4.4.** σ = (4, 1, 5, 3, 2) ∈ S₅

Алгоритм разложения:
```
Шаг 1: Начинаем с элемента 1
  1 → σ(1) = 4 → σ(4) = 3 → σ(3) = 5 → σ(5) = 2 → σ(2) = 1
  Цикл: (1 4 3 5 2) — это цикл длины 5

Результат: σ = (1 4 3 5 2)
Количество циклов: 1
```

**Более сложный пример:**

**Пример 4.5.** σ = (2, 3, 1, 5, 4) ∈ S₅

Разложение:
```
Начинаем с 1: 1 → 2 → 3 → 1   →  Цикл (1 2 3)
Продолжаем с 4: 4 → 5 → 4     →  Цикл (4 5)

Результат: σ = (1 2 3)(4 5)
Количество циклов: 2
Порядок: lcm(3, 2) = 6
```

### Циклический тип и количество перестановок

**Формула для подсчета:**

**Теорема 4.4.** Количество перестановок в Sₙ с заданным цикловым типом λ = (λ₁, λ₂, ..., λₖ) (где λ₁ + λ₂ + ... + λₖ = n) равно:

$N(λ) = \frac{n!}{\prod_{i=1}^{n} m_i! \cdot i^{m_i}}$

где mᵢ — количество циклов длины i в типе λ.

**Доказательство:** 
- Выбрать элементы для каждого цикла: n!/(λ₁!λ₂!...λₖ!)
- Учесть, что циклы одинаковой длины неразличимы: разделить на m₁! · m₂! · ...
- Учесть циклическую симметрию: каждый цикл длины i имеет i эквивалентных представлений

**Примеры вычисления:**

**Пример 4.6.** Для S₄ с типом (2, 2):

m₁ = 0 (нет 1-циклов), m₂ = 2 (два 2-цикла), m₃ = 0, m₄ = 0

$N((2,2)) = \frac{4!}{2! \cdot 2^2} = \frac{24}{2 \cdot 4} = 3$

Перестановки: (2,1,4,3), (3,1,4,2), (4,2,3,1)

**Пример 4.7.** Для S₅ с типом (3, 2):

m₁ = 0, m₂ = 1, m₃ = 1, m₄ = 0, m₅ = 0

$N((3,2)) = \frac{5!}{1! \cdot 1! \cdot 2^1 \cdot 3^1} = \frac{120}{2 \cdot 3} = 20$



# 5. ЧЕТНОСТЬ И ЗНАК ПЕРЕСТАНОВКИ

## 5.1 Инверсии и знак перестановки

**Определение 5.1.** Инверсией в перестановке $(a_1, a_2, ..., a_n)$ называется пара индексов (i, j) такая, что i < j, но $a_i > a_j$.

**Пример 5.1.** Для перестановки (3, 1, 4, 2) инверсии: (1,2), (1,4), (3,4). Всего 3 инверсии.

**Определение 5.2.** Перестановка четная, если количество инверсий четно, нечетная — если нечетно.

Знак перестановки: $sgn(σ) = (-1)^n$, где n — число инверсий

**Теорема 5.1.** Для любых $σ, τ ∈ S_n$:

$sgn(σ ∘ τ) = sgn(σ) · sgn(τ)$

**Доказательство.** Любая подстановка раскладывается в произведение транспозиций. Каждая транспозиция меняет четность, поэтому четность произведения — произведение четностей. 


**Определение 5.3.** Альтернирующей группой Aₙ называется множество четных перестановок из Sₙ.

**Теорема 5.2.** Aₙ — подгруппа Sₙ порядка n!/2 при n ≥ 2.

| n | \|Sₙ\| | \|Aₙ\| | Примеры четных |
|---|---|---|---|
| 2 | 2 | 1 | (1,2) |
| 3 | 6 | 3 | e, (1 2 3), (1 3 2) |
| 4 | 24 | 12 | все 3-циклы |

### Дополнительные свойства

**Трансвекции:**

**Определение 5.4.** Трансвекцией (или элементарной операцией) называется транспозиция соседних элементов (i, i+1).

Множество всех трансвекций порождает всю симметрическую группу Sₙ.

**Связь с четностью:**

**Теорема 5.2.** Любая транспозиция (i, j) может быть представлена как произведение трансвекций:

$(i, j) = (i, i+1)(i+1, i+2)...(j-1, j)(j-2, j-1)...(i+1, i+2)(i, i+1)$

**Доказательство:** 
- «Поднимаем» элемент с позиции i на позицию j через последовательные обмены с соседями
- Затем возвращаем элемент, исходно стоявший на позиции j, на позицию i
- Всего требуется 2(j-i)-1 трансвекций

**Связь между инверсиями и минимальным числом транспозиций:**

**Теорема 5.3.** Минимальное количество транспозиций, необходимых для получения перестановки σ из тождественной, равно:

$t(σ) = n - c(σ)$

где c(σ) — число циклов в разложении σ.

**Доказательство:** 
Каждая транспозиция увеличивает количество циклов не более чем на 1. Начинаем с n циклов (каждый элемент — отдельный цикл), нужно достичь c(σ) циклов, поэтому требуется ровно n - c(σ) операций.

**Пример:**

**Пример 5.2.** σ = (2, 3, 1, 4) = (1 2 3)

- c(σ) = 2 (циклы: (1 2 3) и (4))
- Минимальное число транспозиций: t = 4 - 2 = 2

Разложение: σ = (1 2) · (1 3) или σ = (1 3) · (2 3)

**Альтернирующая группа A_n:**

**Определение 5.5.** Альтернирующей группой Aₙ называется подмножество четных перестановок из Sₙ, т.е.

$A_n = \{ σ \in S_n : \text{sgn}(σ) = 1 \}$

**Свойства:**

**Теорема 5.4.** Альтернирующая группа Aₙ является нормальной подгруппой Sₙ индекса 2.

**Свойства:**
- $|A_n| = \frac{n!}{2}$ для n ≥ 2
- Aₙ порождается 3-циклами: любая четная перестановка — произведение 3-циклов
- Композиция двух четных перестановок четная
- Aₙ проста для n ≥ 5 (не имеет нетривиальных нормальных подгрупп)


## 5.2 Вычисление знака перестановки

### Метод через инверсии

**Пример 5.3.** σ = (4, 1, 3, 2)

Инверсии: (1,2), (1,3), (1,4), (3,4) — всего 4 инверсии (четное число)

sgn(σ) = (-1)⁴ = +1 → четная перестановка

### Метод через цикловую структуру

**Пример 5.4.** σ = (1 2 3 4)(5 6)

- Цикл длины 4: четность = (-1)⁴⁻¹ = -1
- Цикл длины 2: четность = (-1)²⁻¹ = -1
- Полная четность: (-1) × (-1) = +1 → четная

### Свойства четности при операциях

**Четность композиции:**

**Теорема 5.5.** sgn(σ ∘ τ) = sgn(σ) · sgn(τ)

**Следствия:**
1. Четность произведения = произведение четностей
2. sgn(σⁿ) = (sgn(σ))ⁿ
3. sgn(σ⁻¹) = sgn(σ)

**Таблица четности операций:**

| Операция | Четность |
|---|---|
| σ — четная, τ — четная | σ ∘ τ четная |
| σ — четная, τ — нечетная | σ ∘ τ нечетная |
| σ — нечетная, τ — нечетная | σ ∘ τ четная |



# 6. ПОРЯДОК ЭЛЕМЕНТА В ГРУППЕ

**Определение 6.1.** Порядком элемента σ ∈ S_n называется минимальное натуральное число k > 0 такое, что σ^k = e.

## Вычисление порядка через циклы

**Теорема 6.1.** Если подстановка раскладывается в произведение независимых циклов длин l_1, l_2, ..., l_m, то:

$ord(σ) = \text{lcm}(l_1, l_2, ..., l_m)$

где lcm — наименьшее общее кратное.

**Доказательство.** Независимые циклы коммутируют. Цикл длины l удовлетворяет γ^l = e и γ^k ≠ e при k < l. Для произведения σ^k = e тогда и только тогда, когда l_i | k для всех i. Наименьшее такое k равно lcm(l_1, ..., l_m). ∎

**Пример 6.1.** Для σ = (1 2 3 4)(5 6) с циклами длин 4 и 2:
$ord(σ) = \text{lcm}(4, 2) = 4$.

---

# 7. ПРИЛОЖЕНИЯ И ПРАКТИЧЕСКИЕ ЗАДАЧИ

## Классификация перестановок

**Цикловой тип:** Цикловым типом подстановки называется набор длин циклов в её разложении.

**Классы сопряженности:**

**Теорема 7.1.** Две подстановки сопряжены в S_n тогда и только тогда, когда имеют одинаковый цикловой тип.

**Таблица 7.1** – Классы сопряженности в S_3

| Цикловой тип | Количество элементов | Примеры |
|---|---|---|
| (1,1,1) | 1 | (1,2,3) — тождество |
| (1,2) | 3 | (2,1,3), (3,2,1), (1,3,2) — транспозиции |
| (3) | 2 | (2,3,1), (3,1,2) — 3-циклы |

Всего: 1 + 3 + 2 = 6 = 3!

---

## Приложения в линейной алгебре

## 8.1 Определитель матрицы

**Определение 8.1.** Определитель матрицы A размера n×n определяется как:

$\det(A) = \sum_{σ \in S_n} \text{sgn}(σ) \cdot a_{1,σ(1)} \cdot a_{2,σ(2)} \cdot ... \cdot a_{n,σ(n)}$

## 8.2 Пример вычисления определителя

**Пример 8.1.** Для матрицы 2×2:

```
  det | a  b |  = ad - bc
      | c  d |
```

здесь ad соответствует тождественной перестановке (sgn = +1), bc — транспозиции (sgn = -1).

## 8.3 Матрицы перестановок (пермаутрицы)

### 8.3.1 Определение и свойства

**Определение 8.1.** Матрицей перестановки (пермаутрицей) P, соответствующей перестановке σ ∈ Sₙ, называется матрица размера n×n, где:

$P[i,j] = \begin{cases} 1, & \text{если } σ(i) = j \\ 0, & \text{иначе} \end{cases}$

**Пример 8.2.** Для σ = (2, 3, 1) матрица перестановки:

```
P = [ 0  0  1 ]
    [ 1  0  0 ]
    [ 0  1  0 ]
```

### 8.3.2 Ключевые свойства пермаутриц

**Теорема 8.1.** Матрица перестановки P обладает следующими свойствами:

1. **Ортогональность:** $P^T P = PP^T = I$
2. **Определитель:** $\det(P) = \text{sgn}(σ)$
3. **Обратная матрица:** $P^{-1} = P^T = P_{σ^{-1}}$
4. **Произведение:** $P_{σ} \cdot P_{τ} = P_{σ \circ τ}$
5. **След:** $\text{tr}(P) = c(σ)$ (число циклов)

**Доказательство свойства 2:**

Определитель матрицы перестановки равен произведению элементов с одной единицей в каждой строке и столбце, что соответствует ровно одному путем в графе перестановки. Каждый цикл длины k имеет четность (-1)^(k-1), поэтому:

$\det(P) = \prod_{i=1}^{m} (-1)^{l_i-1} = (-1)^{n-c(σ)} = \text{sgn}(σ)$

### 8.3.3 Пример вычисления определителя через пермаутрицу

**Пример 8.3.** Матрица:

```
A = [ 2  0  3 ]
    [ 1  4  0 ]
    [ 0  5  2 ]
```

$\det(A) = \sum_{σ \in S_3} \text{sgn}(σ) \cdot a_{1,σ(1)} \cdot a_{2,σ(2)} \cdot a_{3,σ(3)}$

Разложим по всем перестановкам:
- σ = (1,2,3): sgn = +1, произведение = 2·4·2 = 16
- σ = (1,3,2): sgn = -1, произведение = 2·0·5 = 0
- σ = (2,1,3): sgn = -1, произведение = 0·1·2 = 0
- σ = (2,3,1): sgn = +1, произведение = 3·1·5 = 15
- σ = (3,1,2): sgn = +1, произведение = 3·4·0 = 0
- σ = (3,2,1): sgn = -1, произведение = 0·1·0 = 0

$\det(A) = 16 + 0 + 0 + 15 + 0 + 0 = 31$

## 8.4 Собственные значения пермаутриц

### 8.4.1 Спектр матрицы перестановки

**Теорема 8.2.** Собственные значения матрицы перестановки P (соответствующей σ ∈ Sₙ) — это корни из единицы, связанные с длинами циклов разложения σ.

Если σ имеет цикловое разложение с длинами l₁, l₂, ..., lₖ, то собственные значения содержат:
- Все $l_i$-е корни из единицы для каждого цикла

**Пример 8.4.** Для σ = (1 2)(3) (цикловое разложение на цикл длины 2 и неподвижную точку):

P имеет собственные значения:
- λ₁ = 1 (от 1-цикла и из-за ортогональности)
- λ₂ = -1 (от 2-цикла)
- λ₃ = 1

Сумма собственных значений: trace(P) = 1 + (-1) + 1 = 1 = c(σ) 

## 8.5 Перманент матрицы

### 8.5.1 Определение перманента

**Определение 8.2.** Перманентом матрицы A размера n×n называется:

$\text{perm}(A) = \sum_{σ \in S_n} a_{1,σ(1)} \cdot a_{2,σ(2)} \cdot ... \cdot a_{n,σ(n)}$

Отличие от определителя: нет множителя sgn(σ), берутся все перестановки с положительным коэффициентом.

### 8.5.2 Свойства перманента

**Теорема 8.3.**

1. $\text{perm}(A) ≥ 0$ для матриц с неотрицательными элементами
2. $\text{perm}(A) = \text{perm}(A^T)$ (симметричность)
3. Для матрицы перестановки: $\text{perm}(P) = 1$ (всегда!)
4. Перманент подсчитывает число совершенных паросочетаний в двудольном графе

### 8.5.3 Приложение: Проблема назначений

**Пример 8.5.** Пусть матрица A[i,j] = стоимость назначения работника i на работу j.

Перманент perm(A) подсчитывает сумму стоимостей всех возможных полных назначений.

Например, для матрицы 2×2:
```
A = [ 3  5 ]
    [ 2  4 ]
```

$\text{perm}(A) = 3 \cdot 4 + 5 \cdot 2 = 12 + 10 = 22$

---

## Приложения в анализе алгоритмов

## 9.1 Сортировка и анализ сложности

Задача сортировки может быть сформулирована как нахождение перестановки σ, которая приводит неупорядоченный массив в отсортированный вид. Количество свопов в алгоритме сортировки связано с цикловой структурой перестановки: требуется (n - число циклов) свопов.

## 9.2 Задача коммивояжера

В задаче коммивояжера (TSP) требуется найти перестановку σ ∈ S_n городов, которая минимизирует суммарное расстояние. Анализ цикловой структуры помогает при локальных оптимизациях.

## 9.3 Анализ перестановочных сортировок

**Теорема 9.1.** Любую подстановку из S_n можно получить композицией не более чем n-1 транспозиций соседних элементов.

## 9.4 Анализ пузырьковой сортировки через перестановки

### 9.4.1 Связь с числом инверсий

**Теорема 9.2.** Число операций обмена (свопов) в пузырьковой сортировке для массива с перестановкой σ равно точно числу инверсий inv(σ).

**Доказательство:** Каждый своп уменьшает число инверсий на 1. Пузырьковая сортировка выполняет число свопов, пока inv(σ) > 0.

### 9.4.2 Анализ сложности

**Следствие 9.1:**
- Лучший случай: O(n) (уже отсортирован, σ = тождество, inv(σ) = 0)
- Худший случай: O(n²) (обратный порядок, σ = (n, n-1, ..., 1), inv(σ) = n(n-1)/2)
- Средний случай: Для случайной перестановки $E[\text{inv}(σ)] = \frac{n(n-1)}{4}$, поэтому O(n²)

### 9.4.3 Пример трассировки

**Пример 9.1.** Сортировка массива [3, 1, 4, 2]:

```
Перестановка σ = (3, 1, 4, 2)
Инверсии: (1,2), (1,4), (3,4) — всего 3 инверсии

Пузырьковая сортировка:
Итерация 1: [3,1,4,2] → [1,3,4,2] (своп 3,1) — осталось 2 инверсии
Итерация 2: [1,3,4,2] → [1,3,2,4] (своп 4,2) — осталось 1 инверсия
Итерация 3: [1,3,2,4] → [1,2,3,4] (своп 3,2) — осталось 0 инверсий

Всего свопов: 3 
```

## 9.5 Сортировка слиянием и анализ инверсий

### 9.5.1 Эффективный подсчет инверсий

**Теорема 9.3.** Используя модифицированную сортировку слиянием, можно подсчитать количество инверсий в O(n log n).

**Алгоритм:**
```python
def merge_count_inversions(arr):
    if len(arr) <= 1:
        return arr, 0
    
    mid = len(arr) // 2
    left, left_inv = merge_count_inversions(arr[:mid])
    right, right_inv = merge_count_inversions(arr[mid:])
    
    merged = []
    inv = left_inv + right_inv
    i = j = 0
    
    while i < len(left) and j < len(right):
        if left[i] <= right[j]:
            merged.append(left[i])
            i += 1
        else:
            merged.append(right[j])
            inv += len(left) - i  # Все оставшиеся элементы левой части > right[j]
            j += 1
    
    merged += left[i:] + right[j:]
    return merged, inv
```

### 9.5.2 Сложность

$T(n) = T(n/2) + T(n/2) + O(n) = O(n log n)$

## 9.6 Анализ случайных перестановок

### 9.6.1 Распределение инверсий

**Теорема 9.4.** Для случайной перестановки σ из Sₙ:

$E[\text{inv}(σ)] = \frac{n(n-1)}{4}$

$\text{Var}[\text{inv}(σ)] = \frac{n(n-1)(2n+5)}{72}$

**Доказательство:** Инверсия — это случайная переменная, равная 1 если i < j и σ(i) > σ(j), с вероятностью 1/2.

### 9.6.2 Асимптотическое распределение

Для больших n распределение числа инверсий приблизительно нормально с параметрами выше.

## 9.7 Асимптотический анализ среднего числа циклов

### 9.7.1 Теорема о средней структуре циклов

**Теорема 9.5.** Для случайной перестановки σ из Sₙ:

$E[c(σ)] = H_n = 1 + \frac{1}{2} + \frac{1}{3} + ... + \frac{1}{n} \approx \ln(n) + γ$

где γ ≈ 0.5772... — постоянная Эйлера-Маскерони.

**Асимптотика:** $E[c(σ)] = \ln(n) + O(1)$

### 9.7.2 Приложение к алгоритму случайной сортировки

Если используется алгоритм, основанный на числе циклов (например, минимальные операции для достижения отсортированного состояния):

Ожидаемое число операций: $E[n - c(σ)] = n - \ln(n) - O(1)$

Это показывает, что в среднем нужно $n - \ln(n)$ транспозиций.

## 9.8 Генерация случайных перестановок

### 9.8.1 Алгоритм Фишера-Йейтса

**Алгоритм 9.1:** Генерация равномерно распределенной случайной перестановки:

```python
import random

def fisher_yates_shuffle(arr):
    """
    Генерирует случайную перестановку за O(n)
    """
    n = len(arr)
    for i in range(n - 1, 0, -1):
        j = random.randint(0, i)
        arr[i], arr[j] = arr[j], arr[i]
    return arr
```

### 9.8.2 Распределение перестановок

Алгоритм гарантирует, что каждая из n! перестановок выбирается с равной вероятностью 1/n!.

### 9.8.3 Сложность

Временная сложность: O(n)
Пространственная сложность: O(n)

---

## Практические задачи и примеры

## 10.1 Задача о расстановке ферзей

Требуется расставить n ферзей на доске n×n так, чтобы ни один не атаковал другого. Решение может быть представлено перестановкой σ ∈ S_n, где σ(i) — столбец, в котором находится ферзь в строке i.

Пример 10.1. Для n = 4 одно из решений: σ = (2, 4, 1, 3).

## 10.2 Задача о derangements

Определение 10.1. Перестановка σ называется derangement, если σ(i) ≠ i для всех i.

Количество derangements в S_n: $D_n = n! \cdot \sum_{k=0}^{n} \frac{(-1)^k}{k!}$

Пример 10.2. Для n = 3: $D_3 = 6 \cdot (1 - 1 + 1/2 - 1/6) = 2$. Это перестановки (2,3,1) и (3,1,2).

## 10.3 Перестановки с ограничениями (problème des rencontres)

### 10.3.1 Перестановки с запретами

**Определение 10.2.** Перестановка σ называется перестановкой с k запретами, если σ(i) ≠ aᵢ для заданного набора условий.

**Пример 10.3.** k студентов забыли свои рюкзаки. Необходимо подсчитать количество способов раздать рюкзаки так, чтобы никто не получил свой собственный.

### 10.3.2 Формула включения-исключения

**Теорема 10.1.** Количество перестановок σ ∈ Sₙ таких, что σ(i) ≠ i для всех i (derangements):

$D_n = n! \sum_{k=0}^{n} \frac{(-1)^k}{k!} \approx \frac{n!}{e}$

**Расширенная версия:** Для задачи с частичными запретами:

$|X| = \sum_{S⊆P} (-1)^{|S|} \cdot (\text{число перестановок с запретами из } S)$

### 10.3.3 Вычисление для малых n

| n | Dₙ (derangements) | n! | Отношение Dₙ/n! | 1/e |
|---|---|---|---|---|
| 1 | 0 | 1 | 0 | 0.368 |
| 2 | 1 | 2 | 0.500 | 0.368 |
| 3 | 2 | 6 | 0.333 | 0.368 |
| 4 | 9 | 24 | 0.375 | 0.368 |
| 5 | 44 | 120 | 0.367 | 0.368 |
| 10 | 1,334,961 | 3,628,800 | 0.3679 | 0.368 |

Видно быстрое сходимение к 1/e ≈ 0.3678...

## 10.4 Латинские квадраты и ортогональные перестановки

### 10.4.1 Определение латинского квадрата

**Определение 10.3.** Латинским квадратом порядка n называется матрица n×n, в каждой строке и каждом столбце которой каждый элемент из {1, 2, ..., n} встречается ровно один раз.

Каждую строку латинского квадрата можно интерпретировать как перестановку.

### 10.4.2 Пример латинского квадрата

**Пример 10.4.** Латинский квадрат порядка 4:

```
L = [ 1  2  3  4 ]
    [ 2  1  4  3 ]
    [ 3  4  1  2 ]
    [ 4  3  2  1 ]
```

Каждая строка — перестановка, каждый столбец — перестановка.

### 10.4.3 Ортогональные латинские квадраты

**Определение 10.4.** Два латинских квадрата L и M порядка n называются ортогональными, если при наложении друг на друга все пары (Lᵢⱼ, Mᵢⱼ) различны.

**Приложение:** Планирование экспериментов, построение систем кодирования.

### 10.4.4 Количество латинских квадратов

Количество латинских квадратов растет экспоненциально:

| n | Число латинских квадратов |
|---|---|
| 1 | 1 |
| 2 | 2 |
| 3 | 12 |
| 4 | 576 |
| 5 | 161,280 |
| 6 | 812,851,200 |

## 10.5 Головоломка "15" (Puzzle-15) как групповая задача

### 10.5.1 Структура головоломки

**Описание:** Головоломка состоит из 16 позиций (4×4), из них 15 пронумерованных плиток и одно пустое место. Плитки можно сдвигать в пустое место.

**Групповая интерпретация:** Конфигурация головоломки — это перестановка σ ∈ S₁₆ (или S₁₅, если рассматривать без пустого места).

### 10.5.2 Теорема о разрешимости

**Теорема 10.2.** Головоломка "15" разрешима (можно привести в целевое состояние) тогда и только тогда, когда количество инверсий в перестановке имеет необходимую четность.

Начальная позиция разрешима ⟺ перестановка четная ⟺ sgn(σ) = +1

**Следствие:** Из 16! ≈ 20 триллионов конфигураций, разрешима ровно половина — 8! · 15 ≈ 10 триллионов.

### 10.5.3 Пример анализа

**Пример 10.5.** Конфигурация:
```
1  2  3  4
5  6  7  8
9  10 11 12
13 14 15 [ ]
```

Как перестановка: (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15) — тождество, четная → разрешима.

Конфигурация с перестановкой 15 и 16 (т.е. 14 и 15 поменяны местами):
```
1  2  3  4
5  6  7  8
9  10 11 12
13 [ ] 15 14
```

Как перестановка: (1,2,3,4,5,6,7,8,9,10,11,12,13,15,14) — одна транспозиция, нечетная → неразрешима!

## 10.6 Криптография и перестановки

### 10.6.1 Перестановочные шифры

**Определение 10.5.** Перестановочным (транспозиционным) шифром называется шифр, в котором буквы открытого текста переставляются согласно фиксированной перестановке σ ∈ Sₖ, где k — длина ключа.

### 10.6.2 Пример: Rail Fence Cipher

**Алгоритм:** Текст записывается в "забор" из n рельсов, затем читается построчно.

**Пример 10.6.** Открытый текст: "HELLO WORLD", n = 3

```
Запись:          Соответствующая перестановка:
H   O   O       1  4  7  10
 E L   W R D     2  5  8  11
  L   L         3  6  9  12

Шифртекст: "HOO ELWRD LL" (читаем по рельсам)
```

Шифр соответствует перестановке σ = (1,4,7,10,2,5,8,11,3,6,9,12) для исходного положения букв.

### 10.6.3 Криптоанализ

**Уязвимость:** Перестановочные шифры уязвимы к частотному анализу и анализу длины ключа.

Если известна длина ключа k, то есть только k! возможных перестановок — перебор по силам современным компьютерам для k ≤ 10.

### 10.6.4 Связь с S-блоками в современной криптографии

В алгоритмах типа DES, AES используются перестановочные слои (P-boxes) как часть механизма смешивания битов:

- S-блоки (substitution): замена значений
- P-блоки (permutation): перестановка битов

Композиция S и P операций дает высокую криптографическую стойкость.

## 10.7 Продвинутые примеры вычисления derangements

### 10.7.1 Рекуррентная формула

**Теорема 10.3.** Количество derangements удовлетворяет рекуррентному соотношению:

$D_n = (n-1)(D_{n-1} + D_{n-2})$

с начальными условиями D₀ = 1, D₁ = 0.

**Доказательство:** Рассмотрим элемент 1:
- Он может быть заменен на элемент i ∈ {2, ..., n} (n-1 выборов)
- Если 1 идет на позицию i, а элемент i идет на позицию 1, то остается derangement для остальных n-2 элементов: D_{n-2} способов
- Если 1 идет на позицию i, но элемент i не идет на позицию 1, то остается perrangement с условием: (n-1) · D_{n-1} способов

### 10.7.2 Таблица вычисленных значений

| n | Dₙ | Dₙ/(n!) | Формула через факториал |
|---|---|---|---|
| 0 | 1 | 1 | 0! · Σ(-1)ᵏ/k! = 1 |
| 1 | 0 | 0 | 0 |
| 2 | 1 | 0.5 | 2! · (1 - 1 + 0.5) = 1 |
| 3 | 2 | 0.333 | 3! · (1 - 1 + 0.5 - 0.167) = 2 |
| 4 | 9 | 0.375 | 4! · (1 - 1 + 0.5 - 0.167 + 0.042) = 9 |
| 5 | 44 | 0.367 | ... |
| 6 | 265 | 0.368 | ... |

### 10.7.3 Асимптотика

**Теорема 10.4.** При n → ∞:

$D_n = \frac{n!}{e} + O(1)$

Более точно:

$D_n = \left\lfloor \frac{n!}{e} + \frac{1}{2} \right\rfloor$ (ближайшее целое число)

Эта формула дает практически мгновенное вычисление Dₙ для любого n.

---

# 8. ТЕСТЫ И ВЕРИФИКАЦИЯ АЛГОРИТМОВ

## 8.1 Тестирование основных операций

### Тестирование композиции перестановок

**Теоретическая основа:** Композиция (σ ∘ τ)(i) = σ(τ(i)) — групповая операция в S_n. 
Свойства: ассоциативность, некоммутативность для n ≥ 3.

**Таблица 11.1** – Результаты тестирования композиции

| Тест | σ | σ (циклы) | τ | τ (циклы) | σ∘τ | (σ∘τ) циклы | σ∘τ = τ∘σ? |
|---|---|---|---|---|---|---|---|
| Тождественные | [2,3,1] | (1 2 3) | [1,2,3] | e | [2,3,1] | (1 2 3) | ✓ |
| Простые циклы S_3 | [2,1,3] | (1 2) | [1,3,2] | (2 3) | [2,3,1] | (1 2 3) | ✗ |
| Произвольные S_4 | [3,1,4,2] | (1 3 4 2) | [1,4,2,3] | (2 4 3) | [3,2,1,4] | (1 3) | ✗ |
| Длинные циклы S_5 | [2,3,4,5,1] | (1 2 3 4 5) | [5,4,3,2,1] | (1 5)(2 4) | [1,5,4,3,2] | (2 5)(3 4) | ✗ |
| Обратные элементы S_6 | [3,1,5,2,6,4] | (1 3 5 6 4 2) | [2,4,1,6,3,5] | (1 2 4 6 5 3) | [1,2,3,4,5,6] | e | ✓ |

**Проверка ассоциативности:** (σ ∘ τ) ∘ ρ = σ ∘ (τ ∘ ρ)

**Таблица 11.2** – Ассоциативность операции композиции

| Перестановка | Значение |
|---|---|
| σ | [3,1,2,4] |
| τ | [2,4,1,3] |
| ρ | [4,3,2,1] |
| (σ∘τ)∘ρ | [2,3,4,1] |
| σ∘(τ∘ρ) | [2,3,4,1] |
| Результат | ✓ АССОЦИАТИВНОСТЬ ВЫПОЛНЕНА |

### Тестирование обратных элементов

**Теоретическая основа:** Для любой перестановки p существует p⁻¹: p ∘ p⁻¹ = p⁻¹ ∘ p = e.
Свойства: (p⁻¹)⁻¹ = p, (p ∘ q)⁻¹ = q⁻¹ ∘ p⁻¹.

**Таблица 11.3** – Результаты тестирования обратных элементов

| Тест | p | p (циклы) | p⁻¹ | p⁻¹ (циклы) | p∘p⁻¹ | = e? | (p⁻¹)⁻¹=p? |
|---|---|---|---|---|---|---|---|
| Тождественная | [1,2,3,4] | e | [1,2,3,4] | e | [1,2,3,4] | ✓ | ✓ |
| Транспозиция | [2,1,3,4] | (1 2) | [2,1,3,4] | (1 2) | [1,2,3,4] | ✓ | ✓ |
| 3-цикл | [2,3,1,4] | (1 2 3) | [3,1,2,4] | (1 3 2) | [1,2,3,4] | ✓ | ✓ |
| 4-цикл | [2,3,4,1] | (1 2 3 4) | [4,1,2,3] | (1 4 3 2) | [1,2,3,4] | ✓ | ✓ |
| Произведение | [3,1,4,2] | (1 3 4 2) | [2,4,1,3] | (1 2 4 3) | [1,2,3,4] | ✓ | ✓ |

### Тестирование циклового разложения

**Теоретическая основа:** Каждая перестановка единственным образом разлагается на произведение непересекающихся циклов.

**Таблица 11.4** – Результаты циклового разложения

| Описание | Группа | Перестановка | Циклы | Разложение | Кол-во | Длины |
|---|---|---|---|---|---|---|
| Тождественная | S_4 | [1,2,3,4] | e | [] | 0 | [1] |
| Транспозиция | S_5 | [2,1,3,4,5] | (1 2) | [[1,2]] | 1 | [2] |
| 2-цикл | S_3 | [2,1,3] | (1 2) | [[1,2]] | 1 | [2] |
| 3-цикл | S_3 | [2,3,1] | (1 2 3) | [[1,2,3]] | 1 | [3] |
| 4-цикл | S_4 | [2,3,4,1] | (1 2 3 4) | [[1,2,3,4]] | 1 | [4] |
| (1 2)(3 4) | S_4 | [2,1,4,3] | (1 2)(3 4) | [[1,2],[3,4]] | 2 | [2,2] |
| (1 2 3)(4 5) | S_5 | [2,3,1,5,4] | (1 2 3)(4 5) | [[1,2,3],[4,5]] | 2 | [3,2] |
| (1 7 6 3)(2 5) | S_7 | [7,5,1,4,2,3,6] | (1 7 6 3)(2 5) | [[1,7,6,3],[2,5]] | 2 | [4,2] |

### Тестирование знака перестановки

**Теоретическая основа:** sgn(p) = (-1)^(число инверсий). 
k-цикл имеет знак (-1)^(k-1).

**Таблица 11.5** – Знак перестановки и инверсии

| Описание | Перестановка | Циклы | Длины | Инверсии | sgn(p) | Теор. знак | Чётность | Проверка |
|---|---|---|---|---|---|---|---|---|
| Тождественная | [1,2,3,4,5] | e | [1] | 0 | 1 | 1 | чётная (+1) | ✓ |
| Транспозиция | [2,1,3,4,5] | (1 2) | [2] | 1 | -1 | -1 | нечётная (-1) | ✓ |
| 2-цикл | [2,1,3] | (1 2) | [2] | 1 | -1 | -1 | нечётная (-1) | ✓ |
| 3-цикл | [2,3,1] | (1 2 3) | [3] | 2 | 1 | 1 | чётная (+1) | ✓ |
| 4-цикл | [2,3,4,1] | (1 2 3 4) | [4] | 3 | -1 | -1 | нечётная (-1) | ✓ |
| 5-цикл | [2,3,4,5,1] | (1 2 3 4 5) | [5] | 4 | 1 | 1 | чётная (+1) | ✓ |
| Две трансп. | [2,1,4,3] | (1 2)(3 4) | [2,2] | 2 | 1 | 1 | чётная (+1) | ✓ |
| Произведение | [2,3,1,5,4] | (1 2 3)(4 5) | [3,2] | 3 | -1 | -1 | нечётная (-1) | ✓ |

**Таблица 11.6** – Проверка мультипликативности sgn(p∘q) = sgn(p)·sgn(q)

| p | sgn(p) | q | sgn(q) | p∘q | sgn(p∘q) | sgn(p)·sgn(q) | Проверка |
|---|---|---|---|---|---|---|---|
| (1 2) | -1 | (2 3) | -1 | (1 2 3) | 1 | 1 | ✓ |
| (1 2 3) | 1 | (1 4 3 2) | -1 | (1 4) | -1 | -1 | ✓ |

### Тестирование порядка перестановки

**Теоретическая основа:** ord(p) = НОК длин циклов. 
ord(p) — минимальное m > 0: p^m = e.

**Таблица 11.7** – Порядок перестановки

| Описание | Группа | Циклы | Длины | НОК | ord(p) | Проверка |
|---|---|---|---|---|---|---|
| Тождественная | S_5 | e | [1] | 1 | 1 | ✓ |
| Транспозиция | S_5 | (1 2) | [2] | 2 | 2 | ✓ |
| 3-цикл | S_5 | (1 2 3) | [3] | 3 | 3 | ✓ |
| 4-цикл | S_5 | (1 2 3 4) | [4] | 4 | 4 | ✓ |
| (1 2)(3 4) | S_5 | (1 2)(3 4) | [2,2] | 2 | 2 | ✓ |
| (1 2 3)(4 5) | S_5 | (1 2 3)(4 5) | [3,2] | 6 | 6 | ✓ |
| (1 2 3 4)(5 6) | S_6 | (1 2 3 4)(5 6) | [4,2] | 4 | 4 | ✓ |
| Сложная | S_9 | (1 2)(3 4 5)(6 7 8 9) | [2,3,4] | 12 | 12 | ✓ |

**Таблица 11.8** – Степени перестановки [7,5,1,4,2,3,6]

| Степень | Перестановка | Циклы | Примечание |
|---|---|---|---|
| p^1 | [7,5,1,4,2,3,6] | (1 7 6 3)(2 5) | исходная |
| p^2 | [6,2,7,4,5,1,3] | (1 6)(3 7) | |
| p^3 | [3,5,6,4,2,7,1] | (1 3 6 7)(2 5) | |
| p^4 | [1,2,3,4,5,6,7] | e | ✓ идентичность (ord=4) |

### Комплексный анализ перестановки

Таблица 11.9 – Анализ [7,5,1,4,2,3,6]

| Свойство                    | Значение                   | Примечание |
|---|---|---|
| Линейная запись             | [7,5,1,4,2,3,6]            |            |
| Циклическая запись          | (1 7 6 3)(2 5)             |            |
| Разложение на циклы         | [[1,7,6,3],[2,5]]          |            |
| Длины циклов                | [4,2]                      |            |
| Количество циклов           | 2                          |            |
| Фиксированные точки         | [4]                        |            |
| Обратная перестановка       | [3,5,6,4,2,7,1]            | (1 3 6 7)(2 5) |
| Знак                         | 1                          | чётная |
| Порядок                      | 4                          | НОК([4,2])=4 |

## 8.2 Реализация алгоритмов

### Класс Permutation на Python
```python
class Permutation:
    """Представляет подстановку как список элементов от 1 до n."""
    
    def __init__(self, mapping):
        """Инициализирует перестановку с валидацией."""
        self._mapping = list(mapping)
        self._n = len(self._mapping)
        if sorted(self._mapping) != list(range(1, self._n + 1)):
            raise ValueError(f"Некорректная перестановка: {self._mapping}")
    
    @property
    def n(self):
        """Размер перестановки."""
        return self._n
    
    def apply(self, i):
        """Применить перестановку σ(i)."""
        if not 1 <= i <= self._n:
            raise IndexError(f"Элемент {i} вне диапазона [1, {self._n}]")
        return self._mapping[i - 1]
    
    def as_list(self):
        """Преобразование в список."""
        return list(self._mapping)

### Основные операции

```python
def compose(sigma, tau):
    """Композиция sigma ∘ tau. Сложность: O(n)."""
    if sigma.n != tau.n:
        raise ValueError("Размеры не совпадают")
    result = []
    for i in range(1, sigma.n + 1):
        result.append(sigma.apply(tau.apply(i)))
    return Permutation(result)

def inverse(perm):
    """Обратная подстановка. Сложность: O(n)."""
    n = perm.n
    inv_mapping = [0] * n
    for i in range(1, n + 1):
        j = perm.apply(i)
        inv_mapping[j - 1] = i
    return Permutation(inv_mapping)

### Анализ перестановок

```python
def get_cycles(perm):
    """Цикловое разложение. Сложность: O(n)."""
    n = perm.n
    visited = [False] * (n + 1)
    cycles = []
    for start in range(1, n + 1):
        if visited[start]:
            continue
        current = start
        cycle = []
        while not visited[current]:
            visited[current] = True
            cycle.append(current)
            current = perm.apply(current)
        if len(cycle) > 1:
            cycles.append(cycle)
    return cycles

def count_inversions(perm):
    """Подсчет инверсий. Сложность: O(n²)."""
    mapping = perm.as_list()
    count = 0
    for i in range(len(mapping)):
        for j in range(i + 1, len(mapping)):
            if mapping[i] > mapping[j]:
                count += 1
    return count

def get_sign(perm):
    """Знак перестановки: +1 если четная, -1 если нечетная."""
    return 1 if count_inversions(perm) % 2 == 0 else -1

def get_order(perm):
    """Порядок перестановки: НОК длин циклов."""
    from math import gcd
    from functools import reduce
    def lcm(a, b):
        return (a * b) // gcd(a, b)
    cycles = get_cycles(perm)
    if not cycles:
        return 1
    return reduce(lcm, [len(c) for c in cycles])
```

### Оптимизация хранения перестановок

**Факториальная система счисления (Lehmer code):**

**Определение 11.1.** Lehmer code (факториальное представление) перестановки σ — это последовательность (c₁, c₂, ..., cₙ₋₁), где cᵢ — количество элементов справа от i-го элемента, которые меньше него.

**Пример 11.1.** σ = (3, 1, 4, 2)

```
Позиция 1 (элемент 3): справа есть 1, 2 < 3 → c₁ = 2
Позиция 2 (элемент 1): справа есть 0 < 1 → c₂ = 0
Позиция 3 (элемент 4): справа есть 1 < 4 → c₃ = 1
Позиция 4 (элемент 2): нет элементов справа → c₄ опускается

Lehmer code: (2, 0, 1)
```

**Преимущества:**

- Использует log(n!) битов вместо n log(n)
- Позволяет быстро вычислить ранг перестановки
- Обратим: из Lehmer code можно восстановить исходную перестановку

**Преобразование между представлениями:**

```python
def permutation_to_lehmer(perm):
    """Преобразует перестановку в Lehmer code"""
    n = len(perm)
    lehmer = []
    
    for i in range(n - 1):
        count = 0
        for j in range(i + 1, n):
            if perm[j] < perm[i]:
                count += 1
        lehmer.append(count)
    
    return lehmer

def lehmer_to_permutation(lehmer):
    """Восстанавливает перестановку из Lehmer code"""
    n = len(lehmer) + 1
    available = list(range(1, n + 1))
    perm = []
    
    for c in lehmer:
        perm.append(available[c])
        available.pop(c)
    
    if available:
        perm.append(available[0])
    
    return perm
```

### Лексикографический порядок на перестановках

**Определение:**

**Определение 11.2.** Перестановка σ лексикографически предшествует τ (σ <_lex τ), если на первой позиции i, где они различаются, σ(i) < τ(i).

**Пример 11.2.** (1,3,2) <_lex (2,1,3) <_lex (2,3,1)

**Реализация:**

```python
def next_permutation(perm):
    """Находит следующую перестановку в лексикографическом порядке
    Алгоритм Нарайаны"""
    
    perm = list(perm)  # Копируем, чтобы не менять исходный
    n = len(perm)
    
    # Находим наибольший индекс i такой что perm[i] < perm[i+1]
    i = n - 2
    while i >= 0 and perm[i] >= perm[i + 1]:
        i -= 1
    
    if i == -1:
        return None  # Это последняя перестановка
    
    # Находим наибольший индекс j > i такой что perm[i] < perm[j]
    j = n - 1
    while j > i and perm[j] <= perm[i]:
        j -= 1
    
    # Меняем местами perm[i] и perm[j]
    perm[i], perm[j] = perm[j], perm[i]
    
    # Обращаем (реверсируем) суффикс, начиная с i+1
    perm[i + 1:] = reversed(perm[i + 1:])
    
    return tuple(perm)

# Пример использования
perm = (1, 2, 3)
while perm:
    print(perm)
    perm = next_permutation(perm)
```

### Ранкирование и анрангирование перестановок

**Ранг перестановки в лексикографическом порядке:**

**Определение 11.3.** Ранг перестановки — это её позиция в лексикографически упорядоченном списке всех перестановок (0-индексированный).

**Пример 11.3.** Для S₃:
- (1,2,3) — ранг 0
- (1,3,2) — ранг 1
- (2,1,3) — ранг 2
- (2,3,1) — ранг 3
- (3,1,2) — ранг 4
- (3,2,1) — ранг 5

**Алгоритм вычисления ранга:**

```python
def permutation_rank(perm):
    """Вычисляет ранг перестановки в лексикографическом порядке"""
    from math import factorial
    
    n = len(perm)
    perm_list = list(perm)
    rank = 0
    
    for i in range(n):
        # Подсчитываем, сколько элементов < perm[i] находятся в perm[i:]
        smaller_count = 0
        for j in range(i + 1, n):
            if perm_list[j] < perm_list[i]:
                smaller_count += 1
        
        # Добавляем вклад: smaller_count * (n-i-1)!
        rank += smaller_count * factorial(n - i - 1)
    
    return rank

# Пример
print(permutation_rank((2, 3, 1)))  # должно быть 3
```

**Обратная операция: получение перестановки по рангу:**

```python
def rank_to_permutation(rank, n):
    """Восстанавливает перестановку по её рангу"""
    from math import factorial
    
    elements = list(range(1, n + 1))
    perm = []
    
    for i in range(n):
        fact = factorial(n - i - 1)
        index = rank // fact
        perm.append(elements[index])
        elements.pop(index)
        rank %= fact
    
    return tuple(perm)

# Пример
print(rank_to_permutation(3, 3))  # должно быть (2, 3, 1)
```

---

# 9. ТЕОРЕТИЧЕСКИЕ ДОПОЛНЕНИЯ

## Теорема Кэли

**Формулировка теоремы:**

**Теорема Кэли (1854).** Любая конечная группа G порядка n изоморфна некоторой подгруппе симметрической группы Sₙ.

**Полное доказательство:**

**Шаг 1: Построение отображения**

Пусть G = {g₁, g₂, ..., gₙ} — конечная группа порядка n, е — её единичный элемент.

Для каждого элемента g ∈ G определим отображение φ_g: G → G как левое умножение:

$φ_g(x) = g \cdot x$

**Шаг 2: Проверка что φ_g — перестановка**

φ_g является биекцией (перестановкой):
- **Инъективность:** Если φ_g(x) = φ_g(y), то g·x = g·y, откуда x = y (из свойств группы)
- **Сюръективность:** Для любого y ∈ G существует x = g⁻¹·y такой что φ_g(x) = g·(g⁻¹·y) = y

Значит, φ_g ∈ Sₙ (перестановка).

**Шаг 3: Построение гомоморфизма**

Определим отображение Φ: G → Sₙ по правилу:

$Φ(g) = φ_g$

Φ — гомоморфизм групп:

$Φ(g·h) = φ_{g·h}(x) = (g·h)·x = g·(h·x) = φ_g(φ_h(x)) = (φ_g ∘ φ_h)(x)$

Поэтому Φ(g·h) = Φ(g) ∘ Φ(h)

**Шаг 4: Инъективность Φ**

Пусть Φ(g) = Φ(h), то есть φ_g = φ_h.

Тогда φ_g(e) = φ_h(e), откуда g·e = h·e, то есть g = h.

Значит, Φ — инъективный гомоморфизм.

**Шаг 5: Заключение**

По теореме о гомоморфизме групп:

$G ≅ Φ(G) ⊆ Sₙ$

Таким образом, G изоморфна подгруппе Sₙ. ✓

### Пример: Циклическая группа Z₄

**Группа:** Z₄ = {e, a, a², a³} с операцией умножения по модулю 4, где a⁴ = e.

**Таблица группы:**

| · | e | a | a² | a³ |
|---|---|---|---|---|
| e | e | a | a² | a³ |
| a | a | a² | a³ | e |
| a² | a² | a³ | e | a |
| a³ | a³ | e | a | a² |

**Построение отображений:**
- φ_e(x) = x (тождество)
- φ_a: e→a, a→a², a²→a³, a³→e (цикл (1 2 3 4))
- φ_{a²}: e→a², a→a³, a²→e, a³→a (циклы (1 3)(2 4))
- φ_{a³}: e→a³, a→e, a²→a, a³→a² (цикл (1 4 3 2))

**Подгруппа в S₄:** ⟨(1 2 3 4)⟩ ≅ Z₄

## История развития теории групп

**Хронология ключевых открытий:**

**1770 — Лагранж и первые идеи**

Жозеф-Луи Лагранж в работе "Réflexions sur la résolution algébrique des équations" рассматривал способы перестановки корней полиномиальных уравнений. Это было первым систематическим использованием перестановок в алгебре.

**1815 — Огюстен-Луи Коши и нотация циклов**

Коши формализовал теорию перестановок и ввел стандартную нотацию для циклов. Его работы содержали первую таблицу цикловых типов для Sₙ.

**1832 — Эварист Галуа и теория Галуа**

Галуа (умер в возрасте 20 лет на дуэли) создал революционную теорию, связывающую разрешимость алгебраических уравнений пятой степени с поведением групп перестановок их корней.

**Главный результат:** Полиномиальное уравнение 5-й степени и выше неразрешимо в радикалах ⟺ его группа Галуа не имеет специальной структуры.

**1854 — Артур Кэли и абстрактная группа**

Кэли ввел определение абстрактной группы и доказал, что любая конечная группа изоморфна подгруппе симметрической группы (теорема Кэли).

Его работа "On the Theory of Groups" положила начало современной теории групп.

**1872 — Камиль Жордан и классификация подгрупп**

Жордан провел глубокий анализ подгрупп Sₙ, классифицировав основные типы и установив результаты о простоте альтернирующей группы Aₙ для n ≥ 5.

| Период | Ученый | Вклад | Значение |
|--------|--------|-------|----------|
| 1770 | Лагранж | Применение перестановок к уравнениям | Рождение идеи |
| 1815 | Коши | Формализация и циклическая нотация | Стандартизация |
| 1832 | Галуа | Теория Галуа, связь с разрешимостью | Революция |
| 1854 | Кэли | Абстрактная группа, теорема Кэли | Основание теории |
| 1872 | Жордан | Классификация подгрупп Sₙ | Структурная теория |

**Современные направления:**

В XX-XXI веках теория групп и симметрической группы получила новые применения:

1. **Квантовая механика:** Представления групп в квантовом анализе
2. **Кристаллография:** Пространственные группы симметрии кристаллов
3. **Информатика:** Криптография, кодирование, анализ алгоритмов
4. **Топология:** Фундаментальная группа, группы гомологий
5. **Теория чисел:** L-функции и автоморфные формы

## Централизатор и нормализатор в Sₙ

**Централизатор элемента:**

**Определение 12.1.** Централизатором элемента g в группе G называется подмножество:

$C_G(g) = \{x ∈ G : xg = gx\}$

**Теорема 12.1.** Для перестановки σ ∈ Sₙ с цикловым разложением σ = (c₁)(c₂)...(cₖ), централизатор содержит все перестановки, которые коммутируют с σ.

Порядок централизатора:

$|C_{S_n}(σ)| = \prod_{i=1}^{n} m_i! \cdot i^{m_i}$

где mᵢ — число циклов длины i.

**Пример 12.1.** Для σ = (1 2)(3 4 5) в S₅:
- m₁ = 0, m₂ = 1, m₃ = 1, остальные 0
- |C(σ)| = 1! · 1¹ · 1! · 3¹ = 1 · 3 = 3

**Нормализатор элемента:**

**Определение 12.2.** Нормализатором элемента g в группе G называется:

$N_G(g) = \{x ∈ G : xgx⁻¹ = g\}$

Для сопряженных элементов (имеющих одинаковый цикловой тип) нормализатор значительно больше централизатора.

## Открытые проблемы и будущие направления

**Гипотеза о диаметре Кэли:**

**Проблема:** Для какого минимального множества образующих Sₙ граф Кэли имеет диаметр, полиномиальный от n?

Граф Кэли группы с образующим множеством S определяет расстояние между элементами как минимальное число образующих, нужное для их композиции.

**Проблема сортировки с "обобщенными" операциями:**

Развитие теории перестановок в сторону несортировочных преобразований и их анализ в контексте современных параллельных алгоритмов.

**Связи с теорией представлений:**

Глубокое изучение матричных представлений Sₙ и их применение к комбинаторике и статистической физике.

**Квантовое вычисление:**

Использование структуры Sₙ в квантовых алгоритмах и квантовом машинном обучении.

## Дополнительные примеры для S₅

**Полная таблица цикловых типов для S₅:**

Всего 7 различных цикловых типов:

| № | Тип | Количество | Примеры | Ср. инверсий |
|---|---|---|---|---|
| 1 | (1,1,1,1,1) | 1 | (1,2,3,4,5) — e | 0 |
| 2 | (2,1,1,1) | 10 | (2,1,3,4,5) | 1 |
| 3 | (2,2,1) | 15 | (2,1,4,3,5) | 2 |
| 4 | (3,1,1) | 20 | (2,3,1,4,5) | 2 |
| 5 | (3,2) | 20 | (2,3,1,4,5) с разными 2-циклами | 3 |
| 6 | (4,1) | 30 | (2,3,4,1,5) | 3 |
| 7 | (5) | 24 | (2,3,4,5,1) | 4 |
| **Итого** | | **120** | | |

**Проверка порядков элементов:**

Для каждого типа в S₅:

| Цикловой тип | Порядок ord(σ) | Формула lcm |
|---|---|---|
| (1,1,1,1,1) | 1 | lcm() = 1 |
| (2,1,1,1) | 2 | lcm(2,1,1,1) = 2 |
| (2,2,1) | 2 | lcm(2,2,1) = 2 |
| (3,1,1) | 3 | lcm(3,1,1) = 3 |
| (3,2) | 6 | lcm(3,2) = 6 |
| (4,1) | 4 | lcm(4,1) = 4 |
| (5) | 5 | lcm(5) = 5 |

**Максимальный порядок в S₅:** 6 (от типа (3,2))

## Справочные таблицы

**Таблица факториалов и перестановок:**

| n | n! | |Sₙ| | |Aₙ| | Dₙ | E[c(σ)] |
|---|---|---|---|---|---|---|---|
| 1 | 1 | 1 | 1 | 0 | 1 |
| 2 | 2 | 2 | 1 | 1 | 1.5 |
| 3 | 6 | 6 | 3 | 2 | 1.83 |
| 4 | 24 | 24 | 12 | 9 | 2.08 |
| 5 | 120 | 120 | 60 | 44 | 2.28 |
| 6 | 720 | 720 | 360 | 265 | 2.45 |
| 7 | 5,040 | 5,040 | 2,520 | 1,854 | 2.59 |
| 8 | 40,320 | 40,320 | 20,160 | 14,833 | 2.72 |
| 10 | 3,628,800 | 3,628,800 | 1,814,400 | 1,334,961 | 2.93 |

**Асимптотические формулы:**

| Величина | Формула | Асимптотика |
|---|---|---|
| n! | Стирлинг | $\sqrt{2πn}(n/e)^n$ |
| Dₙ | Включение-исключение | $n!/e + O(1)$ |
| E[c(σ)] | Harmonic sum | $\ln(n) + γ + O(1/n)$ |
| Макс порядок | Функция Ландау | $e^{(1+o(1))√{\ln(n)\ln\ln(n)}}$ |

---

# 10. ЗАКЛЮЧЕНИЕ

В данной работе проведено систематическое исследование теории перестановок и симметрической группы S_n. Основные результаты включают:

1. Доказательство ключевых теорем (групповая структура, цикловое разложение, мультипликативность знака).

2. Анализ практических приложений в линейной алгебре (определители), теории алгоритмов (сортировка, TSP) и дискретной математике.

3. Разработку и анализ эффективных алгоритмов для основных операций с временной сложностью от O(n) до O(n²).

4. Комплексное тестирование всех операций с использованием таблиц верификации.

Теория перестановок остается активной областью исследований с приложениями в криптографии, комбинаторной оптимизации и теоретической информатике.

---

# 11. СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ

1.     [Линал 2 | Симметрическая группа. Подстановки.Антисимметричные формы. Произведение ПЛФ.](https://www.youtube.com/watch?v=ASsEVLgTKBk)  - ИТМО

2.     [ИТМО вики](1.%09https:/neerc.ifmo.ru/wiki/index.php?title=%D0%93%D1%80%D1%83%D0%BF%D0%BF%D0%B0&mobileaction=toggle_view_desktop)

3.     [ХНУР АиГ Лекция 6 Симметрическая группа](https://studfile.net/preview/3023027/)
4.     [МГУ ВМК (pdf‑лекция): “Группы… Симметрическая группа перестановок. Подгруппы. Теорема Кэли.”](https://mk.cs.msu.ru/images/1/17/Dm_lection9.pdf)
5.     [НИУ ВШЭ (pdf‑конспект А.А. Кириллова): “Лекция 6. Модель группы SnSn”](https://math.hse.ru/data/2019/04/16/1176673162/%D0%BB%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%206_16apr.pdf)
6.     [НИУ ВШЭ (pdf‑конспект А.А. Кириллова): “Лекция 6. Модель группы SnSn”](https://publications.hse.ru/pubs/share/direct/872342935.pdf)
7.     [МЦНМО (pdf‑лист): “Симметрическая группа”](https://old.mccme.ru/ium/postscript/f17/algebra1-task06.pdf)



